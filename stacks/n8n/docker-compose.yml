# n8n â€“ workflow automation. Portainer-friendly: env defaults, external monitor network.
# Access via Caddy only (reverse_proxy n8n:5678). No host ports exposed.
# Set N8N_HOST and WEBHOOK_URL in .env to your Caddy hostname (e.g. https://n8n.home or https://n8n.bolens.dev).
services:
  n8n:
    image: docker.n8n.io/n8nio/n8n:latest
    container_name: n8n
    restart: unless-stopped
    volumes:
      - n8n_data:/home/node/.n8n
      # Optional: share host directory for Read/Write Files from Disk node (path /files in n8n)
      # - ./local-files:/files
    networks:
      - default
      - monitor
    environment:
      - TZ=${TZ:-America/Denver}
      - LANG=${LANG:-en_US.UTF-8}
      - LC_ALL=${LC_ALL:-en_US.UTF-8}
      - LC_CTYPE=${LC_CTYPE:-en_US.UTF-8}
      - N8N_HOST=${N8N_HOST}
      - N8N_PORT=5678
      - N8N_PROTOCOL=${N8N_PROTOCOL:-https}
      - WEBHOOK_URL=${WEBHOOK_URL}
      - NODE_ENV=production
      - N8N_ENCRYPTION_KEY=${N8N_ENCRYPTION_KEY:-}

networks:
  monitor:
    name: monitor
    external: true

volumes:
  n8n_data: {}
